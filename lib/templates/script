#!/bin/sh
set -e

NAME=<PACMAN.NAME>
VERSION=<PACMAN.VERSION>
SHARE=<PACMAN.SHARE>
HOOK=<PACMAN.HOOK>
ACTION=<PACMAN.ACTION>
SYSROOT=<PACMAN.SYSROOT>
DISTRIBUTION="<PACMAN.DISTRIBUTION>"
WPKGACT="$1"
[ "$1" = cmake ] && CMAKE_BINARY_DIR="$2" || CMAKE_BINARY_DIR=

[ -z "$NAME" ] && NAME="$2"
[ -z "$VERSION" ] && VERSION="$3"

_DISTRIBUTION="$(echo $DISTRIBUTION | tr -d '<>')"
[ "$_DISTRIBUTION" = "PACMAN.DISTRIBUTION" ] && DISTRIBUTION="$PEON_DISTRIBUTION"

xcraft-peon "$(pwd)" "$SHARE" "$HOOK" $ACTION "$WPKGACT" "$CMAKE_BINARY_DIR" "$NAME" "$VERSION" "$SYSROOT" "$DISTRIBUTION"
